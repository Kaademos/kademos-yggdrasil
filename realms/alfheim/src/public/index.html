<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Alfheim - Cloud Drive</title>
<style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:sans-serif;background:linear-gradient(135deg,#E3F2FD 0%,#BBDEFB 50%,#90CAF9 100%);min-height:100vh;padding:2rem}.container{max-width:1200px;margin:0 auto}header{text-align:center;margin-bottom:3rem;padding:2rem;background:linear-gradient(135deg,#FFD700 0%,#FFA500 100%);border-radius:15px}h1{font-size:2.5rem;color:#3E2723;margin-bottom:0.5rem}.owasp-badge{display:inline-block;background:#D32F2F;color:white;padding:0.5rem 1rem;border-radius:20px;font-size:0.9rem;margin-top:1rem;font-weight:bold}.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:2rem;margin-bottom:2rem}.card{background:rgba(255,255,255,0.9);border:2px solid#2196F3;border-radius:15px;padding:1.5rem}.card h2{color:#1976D2;margin-bottom:1rem;border-bottom:2px solid#2196F3;padding-bottom:0.5rem}button{width:100%;padding:0.75rem;background:linear-gradient(135deg,#2196F3 0%,#1976D2 100%);border:none;border-radius:8px;color:white;font-size:1rem;font-weight:bold;cursor:pointer;margin-bottom:0.5rem}button:hover{transform:translateY(-2px)}.bucket-item{background:rgba(33,150,243,0.1);border:1px solid#2196F3;border-radius:8px;padding:1rem;margin-bottom:0.5rem;cursor:pointer}.bucket-item:hover{background:rgba(33,150,243,0.2)}.object-item{background:rgba(255,215,0,0.1);border:1px solid#FFD700;border-radius:5px;padding:0.5rem;margin-bottom:0.3rem;cursor:pointer;font-family:monospace}.hint{background:rgba(255,193,7,0.2);border-left:4px solid#FFC107;padding:1rem;margin-top:1rem;border-radius:5px;font-size:0.9rem}.success{background:rgba(76,175,80,0.2);border-left:4px solid#4CAF50;padding:1rem;margin-top:1rem;border-radius:5px}.flag{background:linear-gradient(135deg,#FFD700 0%,#FFA500 100%);border:3px solid#FF6F00;border-radius:15px;padding:2rem;text-align:center;margin-top:1rem}.flag h3{color:#3E2723;font-size:1.5rem;margin-bottom:1rem}.flag-value{font-family:monospace;font-size:1.2rem;color:#BF360C;font-weight:bold;word-break:break-all}pre{background:#263238;color:#ADBAC7;padding:1rem;border-radius:5px;overflow-x:auto;font-size:0.9rem}</style>
</head><body>
<div class="container"><header><h1>‚òÅÔ∏è ALFHEIM</h1><p>Cloud Realm Storage Service</p><span class="owasp-badge">OWASP A02:2025 - Security Misconfiguration</span></header>
<div class="grid">
<div class="card"><h2>üóÇÔ∏è Buckets</h2><button onclick="listBuckets()">List All Buckets</button><div id="bucketList"></div><div class="hint"><strong>üí° Hint:</strong> IAM policy misconfigured - can you access private buckets?</div></div>
<div class="card"><h2>üìÑ Objects</h2><div id="objectList"></div><div class="hint"><strong>üí° Hint:</strong> Click a bucket to list its objects, then click an object to view its content.</div></div>
<div class="card"><h2>üîê Metadata Service</h2><button onclick="getMetadata()">Get Instance Metadata</button><button onclick="getCredentials()">Get Credentials</button><div id="metadataResult"></div><div class="hint"><strong>üí° Hint:</strong> Cloud metadata endpoint exposed at /.well-known/credentials</div></div>
</div><div id="contentDisplay"></div></div>
<script>
async function listBuckets(){try{const r=await fetch('/api/buckets');const d=await r.json();if(d.success){document.getElementById('bucketList').innerHTML='<div class="success">'+d.buckets.map(b=>'<div class="bucket-item" onclick="listObjects(\''+b.name+'\')"><strong>'+b.name+'</strong> '+(b.public?'<span style="color:#4CAF50">PUBLIC</span>':'<span style="color:#FF9800">PRIVATE</span>')+'<br><small>Objects: '+b.objectCount+'</small></div>').join('')+'<p style="margin-top:1rem"><em>'+d.warning+'</em></p></div>';}}catch(e){}}
async function listObjects(bucket){try{const r=await fetch('/api/bucket/'+bucket+'/objects');const d=await r.json();if(d.success){document.getElementById('objectList').innerHTML='<div class="success"><h3>'+bucket+'</h3>'+d.objects.map(o=>'<div class="object-item" onclick="getObject(\''+bucket+'\',\''+o+'\')">'+o+'</div>').join('')+'</div>';}}catch(e){}}
async function getObject(bucket,key){try{const r=await fetch('/api/object/'+bucket+'/'+key);const d=await r.json();if(d.success){document.getElementById('contentDisplay').innerHTML='<div class="card"><h2>üìÑ '+key+'</h2><pre>'+d.object.content+'</pre>'+(d.object.content.includes('YGGDRASIL')?'<div class="flag"><h3>üèÜ Flag Found!</h3><div class="flag-value">'+d.object.content+'</div></div>':'')+'</div>';}}catch(e){}}
async function getMetadata(){try{const r=await fetch('/.well-known/metadata');const d=await r.json();if(d.success){document.getElementById('metadataResult').innerHTML='<div class="success"><strong>Instance Metadata:</strong><pre>'+JSON.stringify(d.metadata,null,2)+'</pre><p>'+d.hint+'</p></div>';}}catch(e){}}
async function getCredentials(){try{const r=await fetch('/.well-known/credentials');const d=await r.json();if(d.success){document.getElementById('metadataResult').innerHTML='<div class="flag"><h3>üö® Credentials Exposed!</h3><pre>'+JSON.stringify(d.credentials,null,2)+'</pre>'+(d.credentials.flag?'<div style="margin-top:1rem"><strong>FLAG:</strong><div class="flag-value">'+d.credentials.flag+'</div></div>':'')+'</div>';}}catch(e){}}
</script></body></html>
